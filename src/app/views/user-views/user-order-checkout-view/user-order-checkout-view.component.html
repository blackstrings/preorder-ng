<div class="row">
  <div class="col">
    <h1>Checkout</h1>

    <app-loading-view [(isScreenLoading)]="isScreenLoading" [(isScreenInitError)]="isScreenInitError"></app-loading-view>

    <!-- hidden cannot be used with ng-container or ng-structures -->
    <div [hidden]="(isScreenLoading && !isScreenInitError)">

      <!-- merchant display info -->
      <div *ngIf="merchant" class="card">
        <div class="card-header">{{merchant.name}}</div>
        <div class="card-body">
          <p>{{merchant.address}}</p>
        </div>
      </div>

      <!-- ordered items/products -->
      <div class="card">
        <ng-container *ngFor="let p of order.orderItems">
          <div class="list-group-item list-group-item-action">
            <span class="badge badge-dark">{{p.product.orderQTY}}</span>
            {{ (p.product.title.length>productNameMaxCharacter)? (p.product.title | slice:0:productNameMaxCharacter)+'...':(p.product.title) }}
            <span class="badge-pill float-right"> {{p.product.calculateTotalPrice() | currency:'USD':'symbol':'1.2-2'}} </span>
          </div>
        </ng-container>
      </div>

      <!-- subtotal and tax -->
      <div class="row mt-4">
        <div class="col-sm text-align-right">
          <div>
            <span>Subtotal: </span>{{order.sub_total | currency:'USD':'symbol':'1.2-2'}}
          </div>
          <div>
            <span>Tax: </span>{{order.tax | currency:'USD':'symbol':'1.2-2'}}
          </div>
          <div class="total-font">
            <strong>Total: {{order.order_total| currency:'USD':'symbol':'1.2-2'}}</strong>
          </div>
        </div>
      </div>

      <!-- Payment info -->
      <hr>
      <div>
        <h3>Payment</h3>
        <!--        <div class="btn-group btn-group-*">-->
        <!--          <button class="btn btn-primary">Change Card</button>-->
        <!--          <button class="btn btn-primary">Add New Card</button>-->
        <!--          <button class="btn btn-primary">PAYPAL</button>-->
        <!--        </div>-->
        <!--        <div>CardType: Mastercard</div>-->
        <!--        <div>Ending in: ...7272</div>-->

        <div #cardDomRef><!-- Elements will create input elements here --></div>

        <!-- stripe element will put the error messages in this element -->
        <div #cardErrorDom id="card-errors" role="alert"></div>

      </div>


      <!-- place order button -->
      <hr>
      <div class="row">
        <div class="col-sm text-align-right">
          <div [hidden]="isPaymentSuccess" class="alert alert-danger">{{paymentErrorMessage}}</div>
          <button #placeOrderBtn id="placeOrderBtn" class="btn-dark btn" (click)="placeOrder()">Place Order</button>
        </div>
      </div>

    </div>

  </div>
</div>
